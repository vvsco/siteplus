---
- hosts: WordPress
  name: Create WordPress service
  become: yes
  gather_facts: yes
  pre_tasks:
    - name: sshd config to accept pubkey PubkeyAuthentication
      lineinfile:
        dest: /etc/ssh/sshd_config
        state: present
        regexp: '^%PubkeyAuthentication'
        line: '%PubkeyAuthentication yes'
    - name: sshd config to accept pubkey AuthorizedKeysFile
      lineinfile:
        dest: /etc/ssh/sshd_config
        state: present
        regexp: '^%AuthorizedKeysFile'
        line: '%AuthorizedKeysFile .ssh/authorized_keys'
  roles:
    - role: thorian93.ansible_role_wordpress